jQuery(function(t){function i(){var i=t("select#product-type").val(),n=e.find(".subscription_scheme").length;"subscription"!==i&&"variable-subscription"!==i&&(n>0?t(".subscription_one_time_shipping").show():t(".subscription_one_time_shipping").hide())}function n(){e.find(".subscription_scheme").each(function(i,n){t(".position",n).val(parseInt(t(n).index(".subscription_schemes .subscription_scheme")))})}var s=t("#wcsatt_data"),e=s.find(".subscription_schemes"),c={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};t.fn.wcsatt_scripts=function(){t(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},t.fn.wcsatt_refresh_scheme_lengths=function(){var i=t(this).find(".wc_input_subscription_length"),n=t(this).find(".wc_input_subscription_period"),s=t(this).find(".wc_input_subscription_period_interval"),e=i.val(),c=parseInt(s.val()),o=!1;i.empty(),t.each(wcsatt_admin_params.subscription_lengths[n.val()],function(n,s){0!=parseInt(n)&&0!=parseInt(n)%c||i.append(t("<option></option>").attr("value",n).text(s))}),i.children("option").each(function(){if(this.value==e)return o=!0,!1}),o?i.val(e):i.val(0)},""===wcsatt_admin_params.post_id&&(s.on("click","h3",function(){var i=t(this).closest(".wc-metabox"),n=i.find(".wc-metabox-content");i.hasClass("closed")?n.show():n.hide(),i.toggleClass("closed")}),s.find(".wc-metabox").each(function(){var i=t(this),n=i.find(".wc-metabox-content");i.hasClass("closed")&&n.hide()})),t.fn.wcsatt_refresh_sync_options=function(){var i=t(this).find(".wc_input_subscription_period"),n=t(this).find(".subscription_sync"),s=n.find(".subscription_sync_annual"),e=n.find(".subscription_sync_week_month"),c=e.find("select"),o=i.val();"day"===o?(n.hide(),c.val(0),s.find('input[type="number"]').val(0)):(n.show(),"year"===o?(e.hide(),s.find('input[type="number"]').val(0),c.val(0),s.show()):(s.hide(),s.find('input[type="number"]').val(0),c.empty(),t.each(WCSubscriptions.syncOptions[o],function(i,n){i||(n=wcsatt_admin_params.i18n_do_no_sync),c.append(t("<option></option>").attr("value",i).text(n))}),e.show()))},t("select#product-type").change(function(){i()}).change(),s.on("woocommerce_subscription_schemes_changed",function(){i()}),e.on("change","select.subscription_pricing_method_input",function(){var i=t(this).val();t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method").hide(),t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method_"+i).show()}),s.find("input#_wcsatt_force_subscription").on("change",function(){t(this).is(":checked")?s.find(".wcsatt_default_status").hide():s.find(".wcsatt_default_status").show()}).change(),e.on("change",".wc_input_subscription_period",function(){t(this).closest(".subscription_scheme").wcsatt_refresh_scheme_lengths(),t(this).closest(".subscription_scheme").wcsatt_refresh_sync_options()}),s.on("click","span.scheme-remove",function(){var i=t(this).closest(".subscription_scheme");return i.find("*").off(),i.remove(),n(),s.trigger("woocommerce_subscription_schemes_changed"),!1}),s.on("click",".expand_all",function(){return e.find(".wc-metabox > .wc-metabox-content").show(),!1}),s.on("click",".close_all",function(){return e.find(".wc-metabox > .wc-metabox-content").hide(),!1});var o=s.find(".wc-metabox").length;s.on("click","button.add_subscription_scheme",function(){s.block(c),o++;var i={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:o,security:wcsatt_admin_params.add_subscription_scheme_nonce};return t.post(wcsatt_admin_params.wc_ajax_url,i,function(i){e.append(i.markup);var c=e.find(".subscription_scheme").last();c.wcsatt_scripts(),t("input#_virtual").change(),c.find("select.subscription_pricing_method_input").change(),n(),s.unblock(),s.trigger("woocommerce_subscription_scheme_added",i),s.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),function(){e.find("select.subscription_pricing_method_input").change();var i=e.find(".subscription_scheme").get();i.sort(function(i,n){var s=parseInt(t(i).attr("rel")),e=parseInt(t(n).attr("rel"));return s<e?-1:s>e?1:0}),t(i).each(function(t,i){e.append(i)}),e.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,i){i.item.css("background-color","#f6f6f6")},stop:function(t,i){i.item.removeAttr("style"),n()}})}()});